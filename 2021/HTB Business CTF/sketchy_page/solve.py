from binascii import unhexlify

# 1st part
chall="4855E589834850EC8B48E105FFFF48FF458948B0058BFFDEFFFF8948B845834820EC0DEB656B6E726C653233642E6C6C48000D8DFFECFFFF55FF48B0C4834820C389834820EC8948EBD9560D726975746C616C416F6C00638D48EC15FFFFFFFFB855834820C48948C045834820EC8948EBD9560F726975746C617250746F636500748D48EA15FFFFFFFFB855834820C48948C845834820EC0DEB6441617669703233642E6C6C48000D8DFFECFFFF55FF48B0C4834820C389834820EC8948EBD943157972747063417571726943656E6F6574747800418D48E415FFFFFFFFB855834820C48948D045834820EC8948EBD9430F797274706D496F707472654B00798D48EA15FFFFFFFFB855834820C48948D845834820EC8948EBD9430D7972747065447263707900748D48EC15FFFFFFFFB855834820C48948E0458D48E85D834830EC894848D9C2C70000000036EB694D7263736F666F20746E456168636E6465522041536120646E41205345432079727470676F61726870636950206F726976656400728D4CC305FFFF49FFC1C700180000B8480000F0000000000089482444FF20D055834830C48B48481B7D8DEBF0082C000210000066200000005300433333525F54454B5F594F44544E545F4C455F4C4E414F59454E212121214821358DFFCDFFFF834830EC894848D9F289C7492CC000004900C1C700000000C74824440120000048007C89282455FF48D8C4834C30278B834820ECC74800C100004800C2C710000000C74900C000104900C1C70004000055FF48C0C4834820C78900E900029D009D40951C892089CBBBB062A8BB37DC83AB374D43CB7A78D100C356EC21C4E694AA368495FF946D0088F16DB007FA722F0EB74BC7E32879B930B06B0CEA3CF0F6BD802A32068E31F7181F4C2AACFC63E5F79D1536043EE1F0283B4C90A441BFE5633B7A6C0EE2584C578009C0EDC8A00307F2FB86A13E1B6A5248E35E637BBD0D70AF362A00C9BF804D79ABD5AD9878ECE39113E4E2D8E3B20E11B41EF979AB34593D4EB3B2FC0EC0B9FBD3633C438610371DF43D7F76CEFF9FC431806920AB86B450BC15DEB231B23D0C4FBB649EE581082A42AEB4E9B0C680070F6A94D10DD286C8F642AA589A79C8AA79B4C36304E016B547C39F3BB2290FCE232C57DA71726BCC506D9E06984C1EE6DACC3A6E2665CD06833F9C25959A21D0D340E50C11F16839A2FDE0FC291782CDB76300956869FB0AE6392D30755E094CD7F03A916A1E9249C049243855BF69004CB30B17A659218C7D9E7EFE2EDD769EB3FED0433847553ABA0C7C38B882F44CA9889322C4A86A4BC09C5CD5B0939FD5B2A5945A55CEB8417F5F6615162B41FEA7DEF53B5A33B426DA439D5FA8A57C394CA89D9917B5601D17C7D912840B25468B7FBB28AFA88160C353F8E977B8EADDE82381996C04B1E5B58667948FD30833B80216F03517B8E775A5EA9E1F1C29B427376AD02E577CC38513F745B1012845F6840269C7316B2226B1E37FB0C989F9DB08188A48DAC1C7020000008D48F235FFFDF3FF48A4C7898D48F85D03C702000000834830EC894C48E1C2C700000000C74901C000004900C1C7000000008948247C48205C89282455FF48E0C48348305D8D48F8EC834820F989C74800C200104900C0C7002000008949FFD9C855834820C48B48B04D8B48B855D7FFC3C900000000"

def decode(string):
    return ''.join([string[i+2:i+4]+string[i:i+2] for i in range(0,len(string),4)])

decoded_chall = unhexlify(decode(chall))
print(repr(decoded_chall))

#2nd part
from wincrypto import *
from wincrypto.constants import *

key = b"S3CR3T_KEY_DONT_TELL_ANYONE!!!!!"
data = unhexlify("488D35CDFFFFFF4883EC304889D94889F249C7C02C00000049C7C10000000048C74424200100000048897C2428FF55D84883C4304C8B274883EC2048C7C10000000048C7C20010000049C7C00010000049C7C104000000FF55C04883C4204889C7E9000200009D409D1C952089CB89B0BBA86237BB83DC37AB434D7ACBD178C300EC56C42194E636AA958494FF006DF188B06DFA072F72B70EC74B28E3B979B0300C6B3CEAF6F080BD322A8E06F7311F182A4CFCACE5639DF736153E04F0E13B28904C41A4E5BF3B636C7AE20E4C588057C009C8ED03A0F20786FB3EA16A1B48525EE37B630DBDAF702A36C90080BF794DD5AB98ADEC7891E3E413D8E2B2E3110E1EB479F934AB3D59B34EFCB2C00EFBB963D3433C10861D373DF4767FFFCEC49F8031206986AB50B415BCB2DEB2310C3DBB4F9E6481E52A08AE42E9B4C6B007806A0FD194D20DC88642F658AA799AAAC8B47963C3E004B516C3473B9F29B2CE0F2C23DA577271CC6B6D50069E4C98E61ECCDA6E3A652606CD3F83259C9A95D02140D30CE5F1113968FDA2FCE01729CD8263B7950069680AFB39E6302D5E754C09F0D7913A1E6A499249C03824BF550069B34C170B59A68C219E7DFE7EDD2E9E76FEB343D047383A550CBA387C82B84CF488A92293A8C44B6A9CC0D55C93B0D59FA5B25A94CE5541B85F7F15662B16FE41DEA73BF5335A26B443DA5F9DA5A8397CA84C999DB5171D60C71712D90B8446257F8B28BBA8AF608153C3E9F8B877DDEA23E89981046CE5B186B59467D38F330802B8F0161735E7B8A5759EEA1C1FB4293727D06A572EC37C138545F701B1452884F6690231C7226BB1267FE3C9B0F98908DB8A18DA48C7C100020000488D35F2FDFFFFF3A44889C7488D5DF8C703000200004883EC304C89E148C7C20000000049C7C00100000049C7C10000000048897C242048895C2428FF55E04883C430488D5DF84883EC204889F948C7C20010000049C7C0200000004989D9FF55C84883C420488B4DB0488B55B8FFD7C9C300000000")


sha1_hasher = CryptCreateHash(CALG_SHA1)
CryptHashData(sha1_hasher, key)
aes_key = CryptDeriveKey(sha1_hasher, CALG_AES_256)
aes_key.key = key

for i in range(len(data)):
    d = data[i:]
    if(len(d) % 16 != 0):
        d = d[:-(len(d)%16)]
    data_d = CryptDecrypt(aes_key,d)
    # if(b'HTB' in data_d):
    print(data_d)
    if b'HTB' in data_d:
        break
    print('---')